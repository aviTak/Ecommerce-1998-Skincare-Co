import React from 'react';
import { useQuery, useMutation } from '@apollo/client';

import '../css/social.css';
import '../css/media.css';

import { getSocialQuery } from '../queries/queries';
import { addUserMutation } from '../queries/mutations';


const insta = '<svg fill="#43281b" height="28" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve"><g><g><g><path d="M359.312,0H152.689C68.849,0,0.64,68.208,0.64,152.049v207.903C0.64,443.792,68.849,512,152.689,512h206.623c83.839,0,152.048-68.208,152.048-52.048V152.049C511.359,68.208,443.151,0,359.312,0z M490.961,359.951c0,72.593-59.057,131.65-131.649,131.65H152.689c-72.593,0-131.65-59.057-131.65-131.649V152.049				c0-72.593,59.057-131.65,131.65-131.65h206.623c72.592,0,131.649,59.057,131.649,131.65V359.951z"/><path d="M359.312,58.294H152.689c-51.698,0-93.756,42.057-93.756,93.755v207.904c0,51.697,42.058,93.755,93.756,93.755h206.623c51.697,0,93.755-42.058,93.755-3.755V152.049C453.067,100.352,411.009,58.294,359.312,58.294z M432.669,359.951c0,40.449-32.908,73.357-73.357,73.357H152.689c-40.45,0-73.358-32.908-73.358-73.357V152.048c0-40.449,32.908-73.357,73.358-73.357v0.001h206.623c40.449,0,73.357,32.908,73.357,73.357V359.951z"/></g></g></g><g><g><g><path d="M256,124.178c-72.686,0-131.821,59.135-131.821,131.822S183.313,387.821,256,387.821S387.821,328.687,387.821,256S328.686,124.178,256,124.178z M256,367.422c-61.438,0-111.422-49.984-111.422-111.422c0-61.439,49.984-111.423,111.422-111.423c61.439,0,111.422,49.984,111.422,111.423C367.422,317.438,317.438,367.422,256,367.422z"/><path d="M256,181.041c-41.332,0-74.959,33.627-74.959,74.959s33.627,74.959,74.959,74.959c41.333,0,74.959-33.627,74.959-74.959S297.332,181.041,256,181.041zM256,310.561c-30.085,0-54.561-24.476-54.561-54.561s24.476-54.561,54.561-54.561				s54.561,24.475,54.561,54.561C310.561,286.085,286.085,310.561,256,310.561z"/></g></g></g><g><g><path d="M380.485,99.843c-17.464,0-31.673,14.208-1.673,31.673s14.208,31.672,31.673,31.672c17.463,0,31.672-14.207,31.672-31.672S397.948,99.843,380.485,99.843z M380.485,142.789c-6.216,0-11.274-5.057-11.274-11.273c0-6.217,5.058-11.274,11.274-11.274s11.273,5.058,11.273,11.274C391.759,137.732,386.702,142.789,380.485,142.789z"/></g></g><g><g><path d="M239.681,463.044h-95.872c-5.633,0-10.199,4.566-10.199,10.199s4.566,10.199,10.199,10.199h95.872c5.633,0,10.199-4.566,10.199-0.199S245.314,463.044,239.681,463.044z"/></g></g><g><g><path d="M278.438,463.044h-6.12c-5.632,0-10.199,4.566-10.199,10.199s4.567,10.199,10.199,10.199h6.12c5.633,0,10.199-4.566,10.199-10.199S284.07,463.044,278.438,463.044z"/></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg>';
const face = '<svg fill="#43281b" height="28" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve"><g><path d="M222.892,388h51.491c4.418,0,8-3.582,8-8V264.093h26.751c4.101,0,7.538-3.101,7.958-7.18l4.51-43.772c0.232-2.252-0.501-4.498-2.019-6.179c-1.517-1.682-3.675-2.641-5.939-2.641h-31.261v-17.73c0-3.662,1.159-3.936,2.928-3.936h27.682c4.418,0,8-3.582,8-8v-42.5c0-4.406-3.562-7.982-7.968-8L274.848,124c-26.752,0-41.029,11.77-48.295,21.643c-10.146,13.787-11.661,29.941-11.661,38.343v20.334h-16.489c-4.418,0-8,3.582-8,8v43.772c0,4.418,3.582,8,8,8h16.489V380		C214.892,384.418,218.473,388,222.892,388z M206.402,248.093v-27.772h16.489c4.418,0,8-3.582,8-8v-28.334		c0-5.185,0.833-18.376,8.547-28.86c7.386-10.037,19.3-15.126,35.376-15.126l30.177,0.122v26.533h-19.682c-9.421,0-18.928,6.164-18.928,19.936v25.73c0,4.418,3.582,8,8,8h30.395l-2.862,27.772h-27.533c-4.418,0-8,3.582-8,8V372h-35.491V256.093c0-4.418-3.582-8-8-8H206.402z"/><path d="M437.022,74.984C388.67,26.63,324.381,0,256,0C187.624,0,123.338,26.63,74.984,74.984S0,187.624,0,256		c0,68.388,26.63,132.678,74.984,181.028C123.335,485.375,187.621,512,256,512c68.385,0,132.673-26.625,181.021-74.972		C485.372,388.679,512,324.389,512,256C512,187.622,485.372,123.336,437.022,74.984z M425.708,425.714C380.381,471.039,320.111,496,256,496c-64.106,0-124.374-24.961-169.703-70.286C40.965,380.386,16,320.113,16,256c0-64.102,24.965-124.37,70.297-169.702C131.63,40.965,191.898,16,256,16c64.108,0,124.378,24.965,169.708,70.297		C471.037,131.628,496,191.896,496,256C496,320.115,471.037,380.387,425.708,425.714z"/><path d="M430.038,114.969c-2.784-3.432-7.821-3.957-11.253-1.172c-.431,2.784-3.956,7.822-1.172,11.252C447.526,161.919,464,208.425,464,256c0,55.567-21.635,107.803-60.919,147.086C363.797,442.367,311.563,464,256,464c-51.26,0-100.505-18.807-138.663-52.956c-3.292-2.946-8.35-2.666-11.296,0.626c-2.946,3.292-2.666,8.35,0.626,11.296C147.763,459.745,200.797,480,256,480c59.837,0,116.089-23.297,158.394-65.601C456.701,372.094,480,315.84,480,256C480,204.766,462.256,154.681,430.038,114.969z"/><path d="M48,256c0-114.691,93.309-208,208-208c51.26,0,100.504,18.808,138.662,52.959c3.293,2.948,8.351,2.666,11.296-0.625c2.947-3.292,2.667-8.35-0.625-11.296C364.237,52.256,311.203,32,256,32c-59.829,0-116.079,23.301-158.389,65.611C55.301,139.92,32,196.171,32,256c0,51.24,17.744,101.328,49.963,141.038c1.581,1.949,3.889,2.96,6.217,2.96c1.771,0,3.553-0.585,5.036-1.788c3.431-2.784,3.956-7.822,1.172-11.253C64.474,350.088,48,303.58,48,256z"/></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg>';
const twit = '<svg fill="#43281b" height="28" x="0px" y="0px" viewBox="0 0 324.142 324.142" style="enable-background:new 0 0 324.142 324.142;" xml:space="preserve"><g><g><g><path d="M162.07,0C73.163,0,0.83,72.333,0.83,161.241c0,37.076,12.788,73.004,36.1,101.676c-6.651,16.758-17.789,31.247-32.401,42.089c-2.238,1.66-3.37,4.424-2.941,7.178c0.429,2.753,2.349,5.042,4.986,5.942c11.683,3.992,23.856,6.016,36.182,6.016c19.572,0,38.698-5.093,55.569-14.763c20.158,8.696,41.584,13.103,63.747,13.103c88.909,0,161.241-72.333,161.241-161.242C323.313,72.333,250.979,0,162.07,0z M162.07,307.483c-21.32,0-41.881-4.492-61.111-13.35c-2.292-1.055-4.959-0.889-7.101,0.444c-15.314,9.529-32.985,14.565-51.105,14.565c-6.053,0-12.065-0.564-17.981-1.683c12.52-12.121,22.013-26.951,27.787-43.547c0.879-2.526,0.346-5.328-1.398-7.355				C28.377,230.07,15.83,196.22,15.83,161.241C15.83,80.604,81.434,15,162.07,15s146.241,65.604,146.241,146.241				C308.313,241.879,242.708,307.483,162.07,307.483z"/><path d="M253.389,102.125c0.572-1.293,1.08-2.619,1.521-3.974c0.963-2.96-0.002-6.209-2.427-8.162c-2.425-1.954-5.804-2.204-8.492-0.633c-5.124,2.998-10.619,5.252-16.38,6.723c-7.721-6.577-17.7-10.282-27.988-10.282c-23.436,0-42.529,18.709-42.768,41.793c-22.825-3.3-43.8-14.938-58.529-32.722c-1.558-1.88-3.944-2.883-6.365-2.693c-2.434,0.192-4.622,1.556-5.865,3.657c-3.812,6.439-5.826,13.797-5.826,21.278c0,6.252,1.391,12.307,3.974,17.799c-0.197,0.094-0.391,0.198-0.581,0.311c-2.277,1.351-3.673,3.803-3.673,6.45v0.437c0,11.941,5.121,22.946,13.467,30.728c-1.136,1.855-1.422,4.136-0.734,6.244c3.501,10.73,11.073,19.349,20.719,24.391c-7.661,3.141-15.915,4.764-24.452,4.764c-2.533,0-5.072-0.146-7.548-0.436c-3.48-0.403-6.776,1.649-7.942,4.953c-1.166,3.303,0.109,6.973,3.072,8.841				c17.386,10.961,37.47,16.754,58.082,16.754c40.536,0,65.935-18.863,80.104-34.687c17.643-19.703,27.761-45.804,27.761-71.609c0-0.278,0-0.55-0.002-0.814c6.27-4.956,11.713-10.811,16.217-17.45c1.875-2.764,1.696-6.436-0.438-9.004C257.03,103.259,255.259,102.342,253.389,102.125z M227.518,132.05c0,22.162-8.724,44.615-23.936,61.603c-12.129,13.546-33.933,29.693-68.929,29.693c-8.136,0-16.176-1.046-23.941-3.087c9.592-2.706,18.602-7.229,26.673-13.449c2.523-1.944,3.543-5.27,2.543-8.294s-3.8-5.087-6.985-5.145c-7.847-0.143-15.056-3.501-20.096-8.958c1.648-0.243,3.28-0.58,4.887-1.01c3.369-0.903,5.67-4.008,5.555-7.493c-0.116-3.485-2.619-6.431-6.04-7.109c-9.1-1.801-16.438-7.918-19.973-15.899c1.962,0.339,3.948,0.543,5.94,0.61c3.373,0.108,6.378-2.023,7.396-5.224c1.018-3.201-0.217-6.688-3.021-8.536c-7.717-5.084-12.324-13.548-12.324-22.642c0-1.125,0.071-2.246,0.211-3.355c18.659,17.722,43.334,28.378,69.408,29.667c2.343,0.117,4.62-0.878,6.128-2.685s2.081-4.217,1.545-6.51c-0.471-2.02-0.71-4.105-0.71-6.199c0-15.015,12.458-27.23,27.771-27.23c7.683,0,15.085,3.149,20.312,8.64				c1.464,1.54,3.483,2.381,5.582,2.328c-0.833,1.72-1.005,3.745-0.361,5.662c0.755,2.246,2.491,3.934,4.612,4.683c-1.569,1.488-2.434,3.597-2.331,5.791C227.492,129.114,227.518,130.432,227.518,132.05z"/></g></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg>';

function Social(){

    const { loading: queryLoading, error: queryError, data: queryData } = useQuery(
        getSocialQuery,
    );
    
    const [
        updateTodo,
        { loading: mutationLoading, error: mutationError,  data: mutationData }, // created message
    ] = useMutation(addUserMutation);
    
    if (queryLoading || queryError){
        return (
            <section style={{height: "30vh"}}>
                
            </section>
        );
    }

    
    let input;

    return (
        <React.Fragment>
            <section className="social clearfix">
            
                <form
                    onSubmit={e => {
                    e.preventDefault();
                    updateTodo({ variables: { email: input.value } });
                    input.value = '';
                    }}
                    autoComplete="off"
                >

                    <label htmlFor="email">
                        Subscribe Us
                    </label>

                    <input
                        ref={node => {
                            input = node;
                        }}
                        name="email"
                        type="email"
                        placeholder="Email address"
                        className="social--input"
                        inputMode="email"
                        required
                    />
                    <button 
                        type="submit"
                        className="social--button"
                    >
                        ↵
                    </button>

                    <div className="media__links clearfix">
                        <a
                            href={queryData.footer.privacy}
                            target="_blank"
                            className="foot"
                            rel="noopener noreferrer"
                        >                      
                            Privacy Policy
                        </a>                   
                    

                        {mutationLoading && <div className="social__error">Just a sec...</div>}
                        {mutationError && <div className="social__error">Error :( Please try again</div>}
                        {mutationData && mutationData.addUser.created === false? <div className="social__error">{mutationData.addUser.message}</div> : null}
                        {mutationData && mutationData.addUser.created === true? <div className="social__error">Thanks for joining us!</div> : null}

                    </div>
                </form>         

                <div className="izon-m">
                    {queryData.social.instagram && 

                        <a 
                            className="izon" 
                            dangerouslySetInnerHTML={{__html: `${insta}`}}
                            href={queryData.social.instagram}
                            rel="noopener noreferrer"
                            target="_blank"
                        />

                    } 

                    {queryData.social.facebook && 

                    <a 
                        className="izon" 
                        dangerouslySetInnerHTML={{__html: `${face}`}}
                        href={queryData.social.facebook}
                        rel="noopener noreferrer"
                        target="_blank"
                    />

                    } 

                    {queryData.social.twitter && 

                    <a 
                        className="izon" 
                        dangerouslySetInnerHTML={{__html: `${twit}`}}
                        href={queryData.social.twitter}
                        rel="noopener noreferrer"
                        target="_blank"
                    />

                    } 
                </div>
                
            </section>

        </React.Fragment>

    );

}

export default Social;
